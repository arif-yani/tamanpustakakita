from odoo import models
from odoo.modules.module import get_module_resource


class SummaryProductKeepXls(models.AbstractModel):
	_name = 'report.my_future_custom.report_summary_product_keep_xls'
	_inherit = 'report.report_xlsx.abstract'


	def generate_xlsx_report(self, workbook, data, orders):
		# for doc in orders:
			report_name = "Rangkuman List Product Keep"
			# One sheet by partner
			sheet = workbook.add_worksheet(report_name[:31])
			body_bold = workbook.add_format({'bold':True, 'align':'left', 'valign':'vcenter', 'font_size':12})
			header_format = workbook.add_format({'bold':True, 'italic':True, 'align':'left', 'valign':'vcenter', 'font_size':16})
			header_format2 = workbook.add_format({'bold':True, 'italic':True, 'underline':True, 'align':'left', 'valign':'vcenter', 'font_size':12})
			# aling_left = workbook.add_format({'bold':True, 'align':'left', 'valign':'vcenter'})
			header_table_format = workbook.add_format({'align':'center', 'valign':'vcenter','font_size':12, 'border':1, 'bold':True,})
			body_table_format = workbook.add_format({'align':'center', 'valign':'vcenter','font_size':12, 'border':1, 'bold':False,})
			left_body_table_format = workbook.add_format({'align':'left', 'valign':'vcenter','font_size':12, 'border':1, 'bold':False,})
			divisi_format = workbook.add_format({'align':'left', 'valign':'vcenter','font_size':12, 'border':0, 'bold':True,})
			# body_italic_format = workbook.add_format({'align':'left', 'font_size':12, 'italic':True})
			# product_table_format = workbook.add_format({'align':'left', 'valign':'vcenter', 'font_size':11, 'border':1})
			# text_format = workbook.add_format({'align':'left', 'valign':'vcenter', 'font_size':11, 'border':0})
			currency_idr_format = workbook.add_format({'align': 'center','border':1, 'font_size':12, 'valign': 'vcenter'})
			currency_idr_format.set_num_format('""* #,##0;-""* #,##0_-;-""* "-"-;_-@')
			currency_idr_format_bold = workbook.add_format({'align': 'center','border':1, 'font_size':12, 'valign': 'vcenter','bold':True})
			currency_idr_format_bold.set_num_format('""* #,##0;-""* #,##0_-;-""* "-"-;_-@')
			sheet.set_column('A:A', 25)
			sheet.set_column('B:B', 20)
			sheet.set_column('C:C', 20)
			sheet.set_column('D:D', 20)
			sheet.set_column('E:E', 20)
			sheet.set_column('F:F', 20)
			sheet.set_column('G:G', 20)
			sheet.set_column('H:H', 20)
			sheet.set_column('I:I', 20)
			sheet.set_column('J:J', 20)
			sheet.merge_range(0, 0, 0, 7, "MY FUTURE", header_format)
			sheet.merge_range(1, 0, 1, 7, "Rangkuman List Product Keep", header_format2)
			row = 3
			row += 1
			sheet.write(row,0, 'KODE PRODUCT', header_table_format)
			sheet.write(row,1, 'PRODUCT', header_table_format)
			sheet.write(row,2, 'SIZE', header_table_format)
			sheet.write(row,3, 'PCS', header_table_format)
			for summary in orders.summary_product_keep():
				row += 1
				sheet.write(row,0, summary['product'].default_code, body_table_format)
				sheet.write(row,1, summary['product'].name, body_table_format)
				sheet.write(row,2, summary['size'].name, body_table_format)
				sheet.write(row,3, summary['pcs'], body_table_format)
				